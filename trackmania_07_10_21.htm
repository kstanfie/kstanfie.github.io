
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
            "http://www.w3.org/TR/html4/loose.dtd">
<HTML lang="en">
	<HEAD>
		<!-- google_ad_section_start -->
		<title>Track Replay Info - TMNF-X</title>
		<!-- google_ad_section_end -->
		<meta content="*" name="Access-Control-Allow-Origin" />
		<meta content="Microsoft Visual Studio .NET 7.1" name="GENERATOR" />
		<meta content="Visual Basic .NET 7.1" name="CODE_LANGUAGE" />
		<meta content="JavaScript" name="vs_defaultClientScript" />
		<meta content="http://schemas.microsoft.com/intellisense/ie5" name="vs_targetSchema" />
		<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
		<meta content="Copyright &copy; 2010, www.tm-exchange.com" name="Copyright" />
		<meta content="TrackMania, TMX, nadeo, trackmania forever" name="Keywords" />
		<meta content="Trackmania Exchange or TMX, is the biggest and best TrackMania track-swapping website! Use this website to share you track creations with the entire TrackMania Community!" name="Description" />
		<!-- <LINK href="main3.css" type="text/css" rel="Stylesheet" /> -->
        <link href="/css/all.min.css?v=78620061" type="text/css" rel="stylesheet"></link>
		<link href="/css/codemirror.css" type="text/css" rel="stylesheet" />
		<link href="/css/additional.css?v=78620061" type="text/css" rel="Stylesheet" />
		<LINK href="/main4.1.css?v=78620061" type="text/css" rel="Stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600&display=swap" rel="stylesheet">
		<!-- OpenGraph -->
		<meta id="OGTitle" property="og:title" content="Track Replay Info"></meta>
		<meta id="OGImg" property="og:image" content="https://images.mania-exchange.com/logos/tm1x/logo_sq.png"></meta>
		<meta id="OGImgW" property="og:image:width" content="1024"></meta>
		<meta id="OGImgH" property="og:image:height" content="1024"></meta>
		<meta property="og:url" content="https://tmnforever.tm-exchange.com/main.aspx?action=trackreplayshow&id=2233" />
		<meta property="og:type" content="website" />
		<meta id="OGText" property="og:description" content="The Track Exchange for Trackmania Nations Forever."></meta>
		<meta id="OGSection" property="og:site_name" content="TMNF-X · Track Replay Info"></meta>
		<meta property="og:locale" content="en_US" />
		<meta id="OGLarge" name="twitter:card" content="summary"></meta>
		<meta name="twitter:creator" content="@trackmania_exchange" />
		<meta name="twitter:site" content="TMNF-Exchange" />
		<meta id="OGTitle2" name="twitter:title" content="Track Replay Info"></meta>
		<meta id="OGText2" name="twitter:description" content="The Track Exchange for Trackmania Nations Forever."></meta>
		<meta id="OGImg2" name="twitter:image" content="https://images.mania-exchange.com/logos/tm1x/logo_sq.png"></meta>
		<meta name="msapplication-TileColor" content="#f30200" />
		<meta name="theme-color" content="#f30200" />

        <style id="cm-genstyles"></style>
	</HEAD>
	<body text="000000" vlink="035d8a" link="003333" bgcolor="ffffff">
		<script src="/script/tooltip.js" type="text/javascript"></script>
		<script src="/script/dropdown.js" type="text/javascript"></script>
		<script src="/script/ajax.js" type="text/javascript"></script>
		<!-- fastforza v 1.7 -->
		<script src="/script/jquery/jquery-latest.js" type="text/javascript"></script>
		<script src="/js/menu.js" type="text/javascript"></script>
		<!-- ### -->
		<form name="MainForm" method="post" action="./2233?action=trackreplayshow&amp;id=2233" id="MainForm">
<div>
<input type="hidden" name="Page.Context" id="Page.Context" value="AQAAAAFIdG1leGNoYW5nZSwgVmVyc2lvbj0yLjAuNzg1OC40MDA2MSwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsAQIBASxUbUV4Y2hhbmdlLkNvbW1vbi5NYXN0ZXJQYWdlLlBvc3RiYWNrQ29udGV4dBIPdHJhY2tyZXBsYXlzaG93AAu5CAAAAAAAAAECAQESVG1FeGNoYW5nZS5NeVN0YWNrAQIBARtUbUV4Y2hhbmdlLlN0YW5kYXJkTG9jYXRpb24SN2h0dHBzOi8vdG1uZm9yZXZlci50bS1leGNoYW5nZS5jb20vdHJhY2tyZXBsYXlzaG93LzIyMzMSEVRyYWNrIFJlcGxheSBJbmZvAwA=" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTk2Nzg5NjU4NmRkzo66MFncxvVe2OF2VmnS3xWm/jNDOMXsT0O9wx1aSTA=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="202EA31B" />
	<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
	<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEdAAZqc2zUMvLJu6FQbzInnJpyh4xtUnIwVOc6HSRZ51VKrZk5Mpdnj9sIpBD/DJOkKXh+xXItP2eI0LQBcmmh20b7rSONURTtLKAqM0kkxYVB83b9bxmE+yMyFpuH50KFZQTKoJ9OlLZL+Hy1vcI7w+s2isEQbmwX5rrnPiK07xKGGw==" />
</div>
			<table class="Outer" cellspacing="0" cellpadding="0" align="center" border="0" width="938"> <!-- 776 -->
				<tr>
					<td class="OuterHeader">
						<table class="NoClass" width="20" cellpadding="0" cellspacing="0" align="left">
							<tr>
								<td>
									<img src="/theme/banner/outer-header.png" id="imgBanner" usemap="#header" border="0" class="imgheader" alt="TrackMania Exchange!" />
							    </td>
							</tr>
							<tr>
								<td class="OuterMenu">
									<table cellpadding="0" cellspacing="0" border="0" width="986">
										<!-- Any Changes, remember to update error.aspx aswell  -->
										<tr><td>
										<ul id="mpxmenu">
											<li><a href="/">&nbsp;<i class="fas fa-home" style="font-size:20px;line-height:18px;padding-top:2px;position:relative;top:2px;"></i>&nbsp;</a></li>
											<li><a href="/tracksearch">Find Tracks</a>
											<ul>
												<li><a href="/tracksearch/1001?mode=1" id="NadeoTracksLink">Nadeo Tracks</a></li>
												<li><a href="/tracksearch?mode=110">Classic Tracks</a></li>
												<li><a href="/tracksearch?mode=308">Favourite Authors</a></li>
												<li><a href="/tracksigns">Track Signs</a></li>
												<li><a href="/trackrandom">Random Track</a></li>
											</ul>
											</li>
											<li><a href="/trackuploadtrack">Upload</a>
											<ul>
												<li><a href="/trackuploadtrack">Upload Track</a></li>
												<li><a href="/recordmassupload">Upload Replays</a></li>
											</ul>
											<li><a href="/userrecords">Leaderboards</a>
											<ul>
												<li><a href="/userrecords?mode=2">Nadeo Tracks</a></li>
												<li><a href="/userrecords?mode=1">Classic Tracks</a></li>
											</ul>
											</li>
											<li><a href="/usershow">Account</a>
											<ul>
												<li><a href="/tracksearch?mode=1">My Tracks</a></li>
												<li><a href="/tracksearch?mode=7">My Records</a></li>
												<li><a href="/tracksearch?mode=11">My Downloads</a></li>
												<li><a href="/forumshow?mode=1">Private Messages</a></li>
											</ul>
											</li>
											<li><a href="/forumsshow">Forums</a></li>
											<li><a href="#" style="position:relative;">PlayPal & PPO<span style="position:absolute;right: -7px;background: #ef5350;top: -10px;padding: 0 5px;border-radius: 10px;box-shadow: black 0 1px 5px;display:none;" class="ppoonlinebadge">0</span></a>
											<ul>
												<li><a href="/playpal">PlayPal</a></li>
												<li><a href="/playpalonline" style="position:relative;">PlayPal Online<span style="position:absolute;right: -7px;background: #ef5350;top: -10px;padding: 0 5px;border-radius: 10px;box-shadow: black 0 1px 5px;display:none;color: white;opacity: 1;" class="ppoonlinebadge">0</span></a></li>
											</ul>
											</li>
											<li><a href="/trackbeta">Beta Area</a></li>
											<li><a href="/usersearch">Users</a></li>
											<li id="PanelBlog"><a href="http://blog.tm-exchange.com">Blog</a></li>
											
										</ul>
										</td></tr>
									</table>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="OuterNavigator">
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td width="1"><img src="/theme/inner-header-left.gif" alt=""></td>
								<td class="NavigatorCell">&nbsp;Location:&nbsp;&nbsp;<a href="javascript:__doPostBack(&#39;ctlNavigator&#39;,&#39;GotoParent|1&#39;)" class="LinkNavigation">Home</a>&nbsp;<img src="/images/navigation_arrow.gif" />&nbsp;<b>Track Replay Info</b></td>
								<td class="NavigatorCell" align="right">
									
									<a id="DoLogin" class="LinkNavigation" href="javascript:__doPostBack(&#39;DoLogin&#39;,&#39;&#39;)">Login</a>
									<b>
										</b>
									<IMG alt="" src="/images/window_footer_links_dot.gif" align="absmiddle" border="0" alt="">
									
									<a id="DoRegister" class="LinkNavigation" href="javascript:__doPostBack(&#39;DoRegister&#39;,&#39;&#39;)">Register&nbsp;</a></td>
							</tr>
						</table>
					</td>
				</tr>
				<tr id="PanelBookmark">
	<td class="OuterBookmark">
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="BookmarkCell">External Link:
									<a id="ShowBookmark" href="https://tmnforever.tm-exchange.com/trackreplayshow/2233" target="_blank">https://tmnforever.tm-exchange.com/trackreplayshow/2233</a></td>
							</tr>
						</table>
					</td>
</tr>

				<tr>
					<td class="OuterContent">
						<table class="ContentTable" width="100%" cellpadding="0" cellspacing="0">
							<tr>
								<td valign="top" class="ContentCell">
									<input name="ctl01$TrackId" type="hidden" id="ctl01_TrackId" value="2233" />
<input name="ctl01$TrackAt" type="hidden" id="ctl01_TrackAt" value="&quot;2008-04-11T21:27:57&quot;" />
<input name="ctl01$ReplayType" type="hidden" id="ctl01_ReplayType" value="0" />
<TABLE id="Table5" cellSpacing="0" cellPadding="0" width="100%" align="center" border="0">
	<TR>
		<TD vAlign="top" width="100%">
			<table width="100%" class="Window" cellspacing="0" cellpadding="0">
	
								<tr>
		<td align="left" valign="top" class="WindowLeft" width="1px"><img src="/theme/window-top-left1.gif" /></td><td class="WindowTopB" width="100%"><table width="100%" cellspacing="0" cellpadding="0">
			<tr>
				<td valign="top" width="1px"><img src="/theme/window-top-left2.gif" /></td><td class="WindowTitle" width="100%" valign="middle" align="left">Replay history</td><td valign="top" width="1px"><img src="/theme/window-top-right2.gif" /></td>
			</tr>
		</table></td><td align="right" valign="top" class="WindowRight" width="1px"><img src="/theme/window-top-right1.gif" /></td>
	</tr>
								<tr>
		<td class="WindowLeft" class="WindowLeft" width="1px"></td><td id="ctl01_Windowrow10" class="WindowText" valign="middle" align="left" width="100%">
                                    Replay history of <a href="/main.aspx?action=trackshow&amp;id=2233">A01 Race</a>. | <input type="checkbox" id="showBestOnly" name="showBestOnly" style="position: relative; top: 2px;"><label for="showBestOnly">Show user's best replays only</label>
								</td><td class="WindowRight" class="WindowRight" width="1px"></td>
	</tr>
								<tr>
		<td class="WindowLeft" class="WindowLeft" width="1px"></td><td id="ctl01_ReplayDataRow" class="WindowContainer" valign="middle" align="left" width="100%">
                                    <div class="replayTimePickerContainer">
                                        <a href="javascript:;" id="dateSliderPrev">Previous</a>
									    <div id="dateSlider"></div>
                                        <a href="javascript:;" id="dateSliderNext">Next</a>
                                    </div>
									<table width="100%" cellpadding="0" cellspacing="0" border="0">
                                        <thead>
                                            <tr>
                                                <td class="WindowHeader1" width="40">Pos.</td>
                                                <td id="ctl01_TimeColumn" class="WindowHeader1" width="100">Time</td>
		
                                                
                                                <td class="WindowHeader1">By</td>
                                                <td class="WindowHeader1" width="100">Difference</td>
                                                <td class="WindowHeader1" width="100">Score</td>
                                                <td class="WindowHeader1">Uploaded</td>
                                                <td class="WindowHeader1" width="10"></td>
                                            </tr>
                                        </thead>
                                        <tbody id="replayBody">
                                            
                                        </tbody>
									</table>
								</td><td class="WindowRight" class="WindowRight" width="1px"></td>
	</tr>
								<tr>
		<td align="left" valign="bottom" class="WindowLeft" width="1px"><img src="/theme/window-bottom-left1.gif" /></td><td class="WindowBottomB" width="100%"><table width="100%" cellspacing="0" cellpadding="0">
			<tr>
				<td valign="bottom" width="1px"><img src="/theme/window-bottom-left2.gif" /></td><td class="WindowFooter" width="100%" valign="middle" align="right">
								</td><td valign="bottom" width="1px"><img src="/theme/window-bottom-right2.gif" /></td>
			</tr>
		</table></td><td align="right" valign="bottom" class="WindowRight" width="1px"><img src="/theme/window-bottom-right1.gif" /></td>
	</tr>
							
</table></TD>
	</TR>
</TABLE>

<link href="/css/nouislider.min.css" type="text/css" rel="stylesheet" />
<style type="text/css">
    .noUi-marker-horizontal.noUi-marker {
        margin-left: -2px;
        width: 4px;
        border-radius: 2px;
        opacity: 0.33;
    }

    .noUi-marker-horizontal.noUi-marker-large {
        height: 10px;
    }

    .noUi-marker-horizontal.noUi-marker-sub {
        height: 5px;
    }

    .noUi-connect {
        background-color: #2196F3;
    }
</style>
<script lang="javascript" src="/js/nouislider.min.js" type="text/javascript"></script>
<script lang="javascript" type="text/javascript" >
    document.addEventListener("DOMContentLoaded", async function () {
        var trackId = JSON.parse((document.getElementById('ctl01_TrackId') || document.getElementById('_ctl1_TrackId')).value);
        var tooltipSlider = document.getElementById('dateSlider');
        var replayBody = document.getElementById('replayBody');
        var replayData = (await requestReplaysApi({ trackid: { value: trackId } }, null, null, null, 1000, null)).Results;
        //var replayData = JSON.parse((document.getElementById('ctl01_ReplayData') || document.getElementById('_ctl1_ReplayData')).value);
        var trackAt = Date.parse(JSON.parse((document.getElementById('ctl01_TrackAt') || document.getElementById('_ctl1_TrackAt')).value));
        var replayType = Number((document.getElementById('ctl01_ReplayType') || document.getElementById('_ctl1_ReplayType')).value);
        var showBestOnly = document.getElementById('showBestOnly');

        var replayTicks = []

        for (let replay of replayData) {
            replay.ReplayAt = Date.parse(replay.ReplayAt);
            //replay.PendingReplayUpdateSince = Date.parse(replay.PendingReplayUpdateSince);
            replay.TrackAt = Date.parse(replay.TrackAt);

            if (replayType == 2) replay.ReplayTime += replay.ReplayRespawns * 10000;

            if (!replayTicks.includes(replay.ReplayAt)) {
                replayTicks.push(replay.ReplayAt);
            }
        }

        replayTicks.sort();

        if (replayTicks.length == 0) replayTicks.push(new Date().getTime() - 1);

        let nowTime = Math.max(replayTicks[replayTicks.length - 1] + 1, new Date().getTime());
        replayTicks.push(nowTime);

        function dateFmt(value) {
            if (value == nowTime) return "Now";

            let date = new Date(value);
            return date.toLocaleString('en-GB');
        }

        let range = {
            'min': replayTicks[0],
            'max': nowTime,
        }

        for (let i = 1; i < replayTicks.length - 1; ++i) {
            let frac = (replayTicks[i] - replayTicks[0]) / (nowTime - replayTicks[0]);
            range[(frac * 100) + '%'] = replayTicks[i]
        }

        function addSimpleNode(addTo, text) {
            let node = document.createElement("td");
            let node2 = document.createElement("div");
            node2.innerText = text;
            node.appendChild(node2);
            addTo.appendChild(node);
            return node2;
        }

        function addUserNode(addTo, userId, userName) {
            let node = addSimpleNode(addTo, '');

            renderUserLink(node, userId, userName);

            return node;
        }

        function formatTime(ms) {
            if (replayType == 3) {
                return ms.toLocaleString('en-US') + " pt.";
            } else {
                let cs = Math.floor(ms / 10) % 100;
                let s = Math.floor(ms / 1000) % 60;
                let min = Math.floor(ms / 60000);

                return String(min) + ":" + String(s).padStart(2, '0') + "." + String(cs).padStart(2, '0');
            }
        }

        for (let replay of replayData) {
            let root = document.createElement("tr");
            replay.posNode = addSimpleNode(root, "");

            let timeNode = addSimpleNode(root, '');
            let link = document.createElement("a");
            link.href = "/get.aspx?action=recordgbx&id=" + replay.ReplayId;
            link.innerHTML = '<i class="fas fa-download" style="color:#000000;"></i> ' + formatTime(replayType == 3 ? replay.ReplayScore : replay.ReplayTime);
            timeNode.appendChild(link);

            if (replayType == 2) {
                let penaltyNode = addSimpleNode(root, '+ ' + (replay.ReplayRespawns * 10).toString() + ' s');
            }

            addUserNode(root, replay.UserId, replay.LoginId);
            replay.diffNode = addSimpleNode(root, "?");
            replay.diffNode.style.color = '#7f7f7f';
            replay.scoreNode = addSimpleNode(root, "?");
            addSimpleNode(root, dateFmt(replay.ReplayAt));
            let validatedNode = addSimpleNode(root, "");
            if (replay.Validated) {
                validatedNode.innerHTML = '<i class="fas fa-check-circle"></i>';
                tippy(validatedNode.firstChild, {
                    content: "Replay is validated with the TrackMania Competition Patch",
                });
            }

            replay.rootNode = root;
            replayBody.appendChild(root);
        }

        let currentBestTime = replayType == 3 ? -1 : 9999999999999999;
        let uploadedAtIsWR = new Set();
        let replayDataSortedByDate = [...replayData];
        replayDataSortedByDate.sort(function (a, b) {
            if (a.ReplayAt == b.ReplayAt) return 0;
            return a.ReplayAt < b.ReplayAt ? -1 : 1;
        });
        for (let replay of replayDataSortedByDate) {
            if (replayType == 3) {
                if (replay.ReplayScore > currentBestTime) {
                    uploadedAtIsWR.add(replay.ReplayAt);
                    currentBestTime = replay.ReplayScore;
                }
            } else {
                if (replay.ReplayTime < currentBestTime) {
                    uploadedAtIsWR.add(replay.ReplayAt);
                    currentBestTime = replay.ReplayTime;
                }
            }
        }

        let slider = noUiSlider.create(tooltipSlider, {
            start: [nowTime],
            tooltips: [{ to: dateFmt }],
            snap: true,
            range: range,
            connect: 'lower',
            pips: {
                mode: 'values',
                values: replayTicks,
                format: {
                    to: function (value) {
                        if (value == nowTime || value == replayTicks[0]) return dateFmt(value);

                        return '';
                    }
                },
                filter: function (value, type) {
                    if (value == nowTime || value == replayTicks[0]) return 1;

                    return uploadedAtIsWR.has(Number(value)) ? 1 : 2;
                },
                density: 100,
            }
        });

        document.getElementById('dateSliderPrev').addEventListener('click', function () {
            let prevVal = slider.steps()[0][0];
            if (prevVal) slider.set(Number(slider.get()) - prevVal);
        });

        document.getElementById('dateSliderNext').addEventListener('click', function () {
            let nextVal = slider.steps()[0][1];
            if (nextVal) slider.set(Number(slider.get()) + nextVal);
        });

        let lastValues;
        function repaintTableData(values) {
            values = values || lastValues;
            lastValues = values;

            let value = values[0];

            let seen = {};
            let prevPos = {};
            let wrTime = {};
            let toggle = false;
            for (let replay of replayData) {
                if (!seen[replay.TrackAt]) seen[replay.TrackAt] = new Set();
                if (!prevPos[replay.TrackAt]) prevPos[replay.TrackAt] = 0;
                let isSeen = seen[replay.TrackAt].has(replay.LoginId);

                if (replay.ReplayAt > value || (isSeen && showBestOnly.checked)) {
                    replay.posNode.innerText = "";
                    replay.diffNode.innerText = "";
                    replay.scoreNode.innerText = "";
                    replay.rootNode.className = "replayHeaders headerInvisible";
                    continue;
                }

                if (!isSeen) {
                    seen[replay.TrackAt].add(replay.LoginId);
                    prevPos[replay.TrackAt] += 1;
                    replay.posNode.innerText = prevPos[replay.TrackAt] + ".";
                } else {
                    replay.posNode.innerText = "";
                }

                let diff = 0;
                if (replayType == 3) {
                    if (wrTime[replay.TrackAt]) {
                        diff = wrTime[replay.TrackAt] - replay.ReplayScore;
                    } else {
                        wrTime[replay.TrackAt] = replay.ReplayScore;
                    }

                    replay.diffNode.innerText = "- " + formatTime(diff);
                } else {
                    if (wrTime[replay.TrackAt]) {
                        diff = replay.ReplayTime - wrTime[replay.TrackAt];
                    } else {
                        wrTime[replay.TrackAt] = replay.ReplayTime;
                    }

                    replay.diffNode.innerText = "+ " + formatTime(diff);
                }

                if (value == nowTime) {
                    replay.scoreNode.innerText = replay.Score ? replay.Score.toLocaleString('en-US') : "-";
                } else {
                    replay.scoreNode.innerText = "n/a";
                }

                let isInvalidated = trackAt != replay.TrackAt;
                replay.rootNode.className = (toggle ? "replayHeaders WindowTableCell2" : "replayHeaders WindowTableCell1") + (isSeen ? " replayHeadersDoubleReplay" : "") + (isInvalidated ? " replayHeadersDoubleReplay strikeout" : "");
                toggle = !toggle;
            }
        }

        slider.on('update', repaintTableData);

        showBestOnly.addEventListener('change', function () {
            repaintTableData();
        });
    });
</script>
								</td>
							</tr>
							<tr>
								<td>
									<table width="100%" cellpadding="0" cellspacing="0">
										<tr>
											<td width="1"><img src="/theme/inner-main-left.gif" alt=""></td>
											<td align="right"><img src="/theme/inner-main-right.gif" alt=""></td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="OuterFooter">
						<table width="100%" cellpadding="0" cellspacing="0">
							<tr>
								<td align="left" valign="bottom" width="1"><img src="/theme/outer-left-bottom2.png" alt=""></td>
								<td class="FooterCell" width="100%">
									<table width="100%" cellpadding="0" cellspacing="0">
										<tr>
											<td>v2.0.0 (Forever) &copy; 2021 tm-exchange.com  &bull; <a href="https://mania-exchange.com/tac.html" target="_blank">Terms and Conditions</a> &bull; <a href="https://mania-exchange.com/privacy.html" target="_blank">Privacy Policy</a></td>
											<td align="right" class="TextQuiet"><span id="ShowStats">(5 queries, 0.0 seconds)</span> <IMG alt="" src="/images/window_footer_links_dot.gif" align="absmiddle" border="0" alt=""> <a href="#">Top</a></td>
										</tr>
									</table>
								</td>
								<td align="right" valign="bottom" width="1"><img src="/theme/outer-right-bottom2.png" alt=""></td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		
<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['MainForm'];
if (!theForm) {
    theForm = document.MainForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>

</form>
		<map name="header" id="header">
			<area href="http://www.tm-exchange.com" coords="0,38,175,96" shape="RECT">
		</map>
		<script src="/js/codemirror.js" type="text/javascript"></script>
		<script src="/js/codemirror-simplemode.js" type="text/javascript"></script>
		<script src="/js/popper.min.js" type="text/javascript"></script>
		<script src="/js/tippy-bundle.umd.min.js" type="text/javascript"></script>
		<script src="/js/placeholder.js" type="text/javascript"></script>
		<script src="/js/emojidefs.js" type="text/javascript"></script>
		<script>
            let enumTrackPrimaryType = {"Race": 0,"Puzzle": 1,"Platform": 2,"Stunts": 3,"Shortcut": 4,};
            let enumEnvironment = {"Stadium": 7,};
            let enumMood = {"Sunrise": 0,"Day": 1,"Sunset": 2,"Night": 3,};
            let enumStyle = {"Normal": 0,"Stunt": 1,"Maze": 2,"Offroad": 3,"Laps": 4,"FullSpeed": 5,"LOL": 6,"Tech": 7,"SpeedTech": 8,"RPG": 9,"PressForward": 10,"Trial": 11,};
            let enumRoutes = {"Single": 0,"Multi": 1,"Symmetric": 2,};
			let enumLbType = { 'Standard': 1, 'Classic': 2, 'Nadeo': 3, 'Uncompetitive': 4 };
			let enumDifficulty = {"Beginner": 0,"Intermediate": 1,"Expert": 2,"Lunatic": 3,};
			let enumOrder = {"UploadedAsc": 1,"UploadedDesc": 2,"UpdatedAsc": 3,"UpdatedDesc": 4,"AwardsAsc": 5,"AwardsDesc": 6,"CommentsAsc": 7,"CommentsDesc": 8,"ActivityAsc": 9,"ActivityDesc": 10,"TrackNameAsc": 11,"TrackNameDesc": 12,"AuthorNameAsc": 13,"AuthorNameDesc": 14,"DifficultyAsc": 15,"DifficultyDesc": 16,"DownloadsAsc": 17,"DownloadsDesc": 18,"ReplayScoreAsc": 19,"ReplayScoreDesc": 20,"AwardsWeekAsc": 21,"AwardsWeekDesc": 22,"AwardsMonthAsc": 23,"AwardsMonthDesc": 24,"AwardedAsc": 25,"AwardedDesc": 26,};
			let enumAntiSpam = {"NewestTrackOnly": 1,"MostRecentlyAwardedOnly": 2,};
            let enumLength = {"15s": 0,"30s": 1,"45s": 2,"1m": 3,"1m 15s": 4,"1m 30s": 5,"1m 45s": 6,"2m": 7,"2m 30s": 8,"3m": 9,"3m 30s": 10,"4m": 11,"5m": 12,"Long": 13,};
		</script>
		<script src="/js/ejs.js?v=78620061" type="text/javascript"></script>
        <script type="text/javascript">
            function stripNadeoColors(str) {
                let output = '';
                for (let i = 0; i < str.length; i++) {
                    if (str[i] == '$') {
					    switch (str[i + 1].toLowerCase()) {
						    case 's':
						    case 't':
						    case 'w':
						    case 'z':
						    case 'g':
						    case 'i':
						    case 'm':
						    case 'n':
						    case 'o':
							    {
								    i++;
								    continue;
							    }
						    case '$':
							    {
								    output = output + '$';
								    i++;
								    continue;
							    }
                        }

					    if (((str.toLowerCase()[i + 1] >= '0') && (str.toLowerCase()[i + 1] <= '9')) || ((str.toLowerCase()[i + 1] >= 'a') && (str.toLowerCase()[i + 1] <= 'f')))
					    {
						    i += 3;
                        }

                        continue;
                    }

                    output += str[i];
                }

                return output;
            }

            async function getPPOPlayers() {
                let playerlistEncoded = await fetch('/apipponline?plist=1');
                let playerlist = await playerlistEncoded.json()
                if (playerlist.length > 0) {
                    let onlineText = 'Online players on PlayPal Online:'
                    for (let player of playerlist) {
                        onlineText += '\n• ' + stripNadeoColors(player.nickname);
					}

                    /*for (let elem of document.getElementsByClassName("ppoonlinebadge")) {
                        tippy(elem, {
                            content: onlineText,
                        });
                    }*/
					
					$('.ppoonlinebadge').text(playerlist.length).show().attr('title', onlineText);
                }
            }
            getPPOPlayers();
        </script>
	</body>
</HTML>
